# 測試指南

## 快速開始

### 1. 準備測試環境

```bash
# 安裝依賴（包含測試庫）
pip install -r requirements.txt

# 啟動服務（在另一個終端）
python app.py
```

### 2. 運行自動化測試

```bash
# 運行完整的自動化測試
python test_api.py
```

自動化測試會測試所有主要功能並顯示結果統計。

### 3. 手動測試步驟

#### 方式一：使用瀏覽器測試 API 信息頁

1. 訪問 `http://localhost:5000`
2. 確認 API 信息頁面正常顯示
3. 查看所有 API 端點列表

#### 方式二：使用命令行測試核心邏輯

```bash
python FoodOrder.py
```

按照提示進行以下測試：
- 員工登入（帳號：93800，密碼：1234）
- 訂購午餐/晚餐
- 取消訂單
- 查詢歷史訂單
- 管理員登入（帳號：admin，密碼：1234）
- 部門/員工/窗口維護

#### 方式三：使用 Postman 測試 API

1. 導入 API 端點（參考 TEST_PLAN.md）
2. 按照測試計劃逐一測試
3. 記錄測試結果

---

## 測試流程建議

### 第一階段：基礎功能驗證（5分鐘）

1. ✅ 啟動服務，訪問根路由
2. ✅ 檢查數據文件是否正確初始化
3. ✅ 員工登入測試
4. ✅ 管理員登入測試

### 第二階段：員工端功能測試（15分鐘）

1. ✅ 今日訂單查詢
2. ✅ 訂購功能（午餐/晚餐）
3. ✅ 取消訂單
4. ✅ 一週訂餐
5. ✅ 歷史訂單查詢
6. ✅ 登出功能

### 第三階段：管理員端功能測試（20分鐘）

1. ✅ 部門主檔 CRUD
2. ✅ 員工主檔 CRUD
3. ✅ 窗口主檔 CRUD
4. ✅ 訂單查詢（含篩選）
5. ✅ 訂單修改（管理員權限）
6. ✅ 統計報表

### 第四階段：邊界條件測試（10分鐘）

1. ✅ 截止時間控制
2. ✅ 錯誤處理
3. ✅ 數據驗證
4. ✅ Session 管理

### 第五階段：整合測試（10分鐘）

1. ✅ 完整訂餐流程
2. ✅ 管理員維護流程
3. ✅ 數據一致性檢查

---

## 測試檢查清單

使用 `TEST_PLAN.md` 中的檢查清單，逐項確認：

- [ ] 所有基礎功能測試通過
- [ ] 所有員工端功能測試通過
- [ ] 所有管理員端功能測試通過
- [ ] 錯誤處理正確
- [ ] 數據文件正確保存
- [ ] Session 管理正確
- [ ] 截止時間控制正確

---

## 常見問題排查

### 問題 1：無法連接到服務

**解決方案：**
- 確認 Flask 應用正在運行（`python app.py`）
- 檢查端口是否為 5000
- 查看終端是否有錯誤訊息

### 問題 2：測試失敗 - 401 Unauthorized

**解決方案：**
- 確認已正確登入
- 檢查 Session 是否有效
- 使用 `check-session` API 驗證

### 問題 3：數據文件錯誤

**解決方案：**
- 檢查 `data/` 目錄是否存在
- 確認 JSON 文件格式正確
- 如有問題，刪除 `data/` 目錄重新初始化

### 問題 4：截止時間測試失敗

**解決方案：**
- 確認當前時間在截止時間之前/之後
- 測試管理員權限應不受截止時間限制
- 檢查 `check_cutoff` 函數邏輯

---

## 測試數據準備

### 預設測試帳號

**員工：**
- 員工編號：`93800`，密碼：`1234`（林淑鈺）
- 員工編號：`28109`，密碼：`1234`（詹金璋）
- 員工編號：`2400305`，密碼：`1234`（王瀚章）

**管理員：**
- 帳號：`admin`，密碼：`1234`

### 測試數據文件位置

- `data/departments.json` - 部門數據
- `data/employees.json` - 員工數據
- `data/windows.json` - 窗口數據
- `data/orders.json` - 訂單數據

---

## 測試報告模板

```
測試日期：YYYY-MM-DD
測試人員：[姓名]
測試環境：Windows/Linux/Mac
Python 版本：[版本號]

測試結果：
- 總測試數：[X]
- 通過：[X]
- 失敗：[X]
- 通過率：[X]%

發現的問題：
1. [問題描述]
2. [問題描述]

建議：
- [建議內容]
```

---

## 進階測試（可選）

### 性能測試

```python
import time
import requests

start = time.time()
for i in range(100):
    requests.get("http://localhost:5000/api/admin/departments")
end = time.time()
print(f"100 次請求耗時: {end - start:.2f} 秒")
```

### 負載測試

使用工具如：
- Apache Bench (ab)
- Locust
- JMeter

---

## 下一步

測試完成後：

1. 記錄所有發現的問題
2. 修復確認的問題
3. 重新運行測試驗證修復
4. 準備部署文檔

